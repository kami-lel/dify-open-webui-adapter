#!/bin/bash

set -euo pipefail

# shellcheck source=/dev/null
source "$(dirname "${BASH_SOURCE[0]}")/set_environment_variables.sh"
# shellcheck source=/dev/null
source "$(dirname "${BASH_SOURCE[0]}")/../hooks_utility/hooks_utility.sh"

# start pre-commit checks  #####################################################
echo "pre-commit" | hooks_utility_enter

hooks_utility_debug_commit_type

# ensure file modification  ----------------------------------------------------

# make sure CHANGELOG.md is edited when finish feature branch
hooks_utility_ensure_changelog_edited 'CHANGELOG.md'

# make sure version is bumped when finish feature branch
hooks_utility_ensure_version_updated

# perform branch protection  ---------------------------------------------------
hooks_utility_protect_branch

# finish pre-commit checks  ####################################################
echo "pre-commit" | hooks_utility_pass

exit 0
